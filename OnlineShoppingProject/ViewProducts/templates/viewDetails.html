{% extends 'basicHome.html' %}

{% load customFunctions %}

{% block title %}{{product.name}} | Wonder Cart {% endblock %}


{% block css %}
<style>
    
    .search{
        width:600px;
    }
</style>
{% endblock %}


{% block search %}

<form  action="/viewProducts/search" class="d-flex mx-2 search">

    <input class="form-control me-2" type="text" name="keyword"  placeholder="Search" aria-label="Search" required>
    <button class="btn btn-outline-success" type="submit">Search</button>

</form>

{% endblock %}


{% block body %}

<div class="container my-4">
    <div class="row">
        <div class="col-md-5 my-2">
            <div class="row">
                <img src="/media//{{product.image}}" width="300px" height="380px">
            </div>
        </div>
        <div class="col-md-7 my-2" >
            <h3>{{product.name}}</h3>

            <div class="center-details">
                <sup>&#x20B9;</sup>
                <h4 style="display: inline-block;">
                    {{product.price|actualPrice:product.discount}}
                </h4>
                {% if product.quantity and product.discount %}
                    &nbsp;<s> &#x20B9;{{product.price}}</s>
                {% endif %}
            </div>

            {% if product.quantity and product.discount > 0 %}
                <h6 class="card-text" style="color:#0004ff">{{product.discount}}% Off</h6>
            {% endif %}

            <h5 class="my-3"> {{product.color}}</h5>
            
            {% if product.category|hasRam %}
                <h5> {{product.ram}} | {{product.storage}}</h5>
            {% endif %}

            <p> {{product.desc|replaceNewLines|linebreaks}}</p>

            {% if not product.quantity %}

                <button class="btn btn-danger">Out Of Stock</button>
            
            {% else %}
            
                <button class="btn btn-primary"> Buy Now</button>

                {% if user.is_authenticated %}

                    {% if product|isProductInCart:user %}
                        <a class="btn btn-primary mx-3" href="/viewCart">Go To Cart</a>
                    {% else %}
                        <a class="btn btn-primary mx-3" aria-current="page" href="/addToCart?id={{product.id}}">Add to Cart</a>
                    {% endif %}
                
                {% else %}
                    <bitton class="btn btn-primary mx-3" data-bs-toggle="modal" data-bs-target="#addtocartmodal" aria-current="page">Add to Cart</button>
                {% endif %}       

            {% endif %}
                
        </div>
    </div>
</div>

<div class="modal fade" id="addtocartmodal" tabindex="-1" aria-labelledby="addtocart" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addtocart">Login to add item in cart</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="/accounts/login" class="btn btn-primary">Log In</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}